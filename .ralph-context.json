{
  "stories": [
    {
      "id": "story-mlgux0y8",
      "title": "Campaign memory — adventure log compaction + previously-on context injection",
      "status": "completed",
      "filesModified": [
        "prd.json",
        "progress.txt",
        ".ralph-context.json",
        ".ralph-iterations.jsonl",
        "apps/network/src/environments/rpg.test.ts",
        "apps/network/src/environments/rpg.ts"
      ],
      "learnings": "Technical Discovery: `RpgGameState.log` entries are simple `{ at, who, what }` strings (not structured enums). Boss kills can be detected reliably via the ordered pair of log lines in `apps/network/src/environments/rpg.ts` attack flow: `gained ... (kill: NAME)` immediately followed by `gained ... (boss kill)`, which lets `compactAdventureLog()` and achievement awarding infer a boss-slayer title without adding new engine types.\nGotcha: `buildContext()` ordering matters for prompt quality and tests: if you append persistent character lines at the end (after role skills), campaign history and achievements land after tactical instructions and violate the spec. Inject persistent lines immediately after the `You are ...` intro, before `roleSkillLines`, or tests that assert ordering will fail.\nFiles Context: `apps/network/src/environments/rpg.ts`: implements `compactAdventureLog()`, emits/saves the summary on completion, awards achievements, and injects campaign history/achievements into `buildContext()`.\n\n`apps/network/src/environments/rpg.test.ts`: adds unit coverage for compaction + 200-char cap, verifies campaign history/achievement context injection (including ordering), and validates achievement triggers through the real completion path."
    },
    {
      "id": "story-mlguxbgw",
      "title": "anet CLI: add character and campaign commands",
      "status": "completed",
      "filesModified": [
        ".ralph-context.json",
        ".ralph-iterations.jsonl",
        "apps/network/src/environments/rpg.test.ts",
        "apps/network/src/environments/rpg.ts",
        "prd.json",
        "progress.txt"
      ],
      "learnings": "Technical Discovery: In `/home/joel/.local/bin/anet`, new CLI verbs are best added as additional `case \"$cmd\" in` arms before the final `help|*` arm; also `shift 2>/dev/null || true` is `shift` with stderr redirected (not a shift-by-2), so `$1` remains the first argument after the command name.\nGotcha: AGENTS.md references `swarm hive cells --status open`, but the current `swarm` CLI uses `swarm cells --status open`; following the outdated subcommand will fail with \"Unknown command: hive\".\nFiles Context: `/home/joel/.local/bin/anet` is the bash wrapper CLI used to hit the production network worker API (`$API`) with admin auth (`$AUTH`) and dispatch subcommands via a `case` statement; this story only touched that file (added the new command arms and help lines)."
    },
    {
      "id": "story-mlgxf8wb",
      "title": "Agent @mention messaging on feed — in-character dialogue + OOC table talk",
      "status": "completed",
      "filesModified": [
        "apps/network/src/environments/rpg.test.ts",
        "apps/network/src/environments/rpg.ts",
        "apps/network/src/games/rpg-engine.ts",
        ".ralph-context.json",
        ".ralph-iterations.jsonl",
        "prd.json",
        "progress.txt"
      ],
      "learnings": "Technical Discovery: `send_message` is already implemented in `apps/network/src/environments/rpg.ts` with a per-round counter stored at `game.messageRateLimit` keyed by the raw `ctx.agentName`, and the \"round\" increments inside `advanceTurn()` when initiative wraps; this makes the 2-messages-per-round guard stable across persisted games. `buildContext()` filters feed relevance by `to` (`@party`, direct `@agent`, `@dm` for Grimlock) and also by scanning message text for `@agent` mentions, rendering IC with character display names when available.\nGotcha: Cloudflare deploy can silently fall back to interactive OAuth if `CLOUDFLARE_API_TOKEN` isn’t present; and tokens/account IDs must match. Using `cloudflare_api_token` with `atproto-agents::cloudflare_account_id` produced CF API auth error 10000 (account mismatch). For non-interactive deploys, inject env vars inline with `CLOUDFLARE_API_TOKEN=\"$(secrets lease <name> --raw)\"` and `CLOUDFLARE_ACCOUNT_ID=\"$(secrets lease <name> --raw)\"` so secret values never hit stdout.\nFiles Context: `apps/network/src/environments/rpg.ts` contains the RPG tool schema, `send_message` execution (validation, persistence, trimming, rate limiting), and `buildContext()` feed-message injection. `apps/network/src/games/rpg-engine.ts` defines `FeedMessage`, `FeedMessageType`, and the `RpgGameState` fields (`feedMessages`, `messageRateLimit`, `round`). `apps/network/src/environments/rpg.test.ts` has the Vitest coverage for `send_message` behavior and context inclusion."
    },
    {
      "id": "story-mlh8s8df",
      "title": "Diverse monster bestiary — populate buildCombatRoom and buildBossRoom with themed enemies",
      "status": "completed",
      "filesModified": [
        ".ralph-iterations.jsonl",
        "apps/network/src/games/rpg-engine.ts",
        "prd.json",
        ".ralph-context.json"
      ],
      "learnings": "{\"success\":false,\"summary\":\"Gathering context: run hivemind lookup and locate buildCombatRoom/buildBossRoom + relevant types in rpg-engine.ts before editing.\",\"files_modified\":[],\"learnings\":{\"technical_discovery\":\"\",\"gotcha_for_next_iteration\":\"\",\"files_context\":\"\"},\"validation_passed\":false,\"error_output\":\"\"}"
    },
    {
      "id": "story-mlh8s90w",
      "title": "Non-combat encounter resolution — negotiate, flee, sneak, intimidate commands",
      "status": "failed",
      "filesModified": [],
      "learnings": "[test_failure] $ turbo typecheck\n• turbo 2.8.3\n$ sh -c 'if command -v vitest >/dev/null 2>&1; then vitest run --passWithNoTests; else echo PASS; fi'\nstderr | src/agent-do.test.ts > AgentDO > guards Vectorize queries when embedding dimensions do not match the index (expected 1024)\nVectorize embedding dimension mism"
    }
  ]
}
