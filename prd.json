{
  "name": "atproto-agent-network",
  "description": "Decentralized agent communication and memory network on Cloudflare",
  "version": "0.1.0",
  "repository": "https://github.com/joelhooks/atproto-agent-network",
  "projectBoard": "https://github.com/users/joelhooks/projects/1",
  "stories": [
    {
      "id": "setup-monorepo",
      "title": "Setup monorepo with Turborepo + Bun",
      "issue": 6,
      "priority": 0,
      "validationCommand": "bun install && bun turbo build --dry-run && echo PASS",
      "files": ["package.json", "turbo.json", ".gitignore"],
      "estimatedMinutes": 10,
      "sprint": "bootstrap"
    },
    {
      "id": "install-vitest",
      "title": "Install Vitest and create root config",
      "issue": 24,
      "priority": 1,
      "validationCommand": "bun test --passWithNoTests 2>&1 | grep -qE '(No test|passed|✓)' && echo PASS",
      "files": ["package.json", "vitest.config.ts"],
      "estimatedMinutes": 15,
      "dependsOn": ["setup-monorepo"],
      "sprint": "testing"
    },
    {
      "id": "identity-tests",
      "title": "Create first unit test for identity.ts",
      "issue": 25,
      "priority": 2,
      "validationCommand": "bun test packages/core/src/identity.test.ts",
      "files": ["packages/core/src/identity.test.ts", "packages/core/src/identity.ts"],
      "estimatedMinutes": 20,
      "dependsOn": ["install-vitest"],
      "sprint": "testing"
    },
    {
      "id": "vitest-workspace",
      "title": "Create vitest workspace config for monorepo",
      "issue": 26,
      "priority": 3,
      "validationCommand": "bun test packages/core 2>&1 | grep -qE '(passed|✓)' && echo PASS",
      "files": ["vitest.workspace.ts", "packages/core/vitest.config.ts"],
      "estimatedMinutes": 15,
      "dependsOn": ["identity-tests"],
      "sprint": "testing"
    },
    {
      "id": "turbo-test-task",
      "title": "Add turbo task for test",
      "issue": 27,
      "priority": 4,
      "validationCommand": "bun turbo test --filter=core 2>&1 | grep -qE '(passed|✓|Tasks:)' && echo PASS",
      "files": ["turbo.json", "packages/core/package.json"],
      "estimatedMinutes": 15,
      "dependsOn": ["vitest-workspace"],
      "sprint": "testing"
    },
    {
      "id": "test-utilities",
      "title": "Create test utilities and fixtures",
      "issue": 15,
      "priority": 5,
      "validationCommand": "bun test packages/core/src/test-utils.test.ts 2>&1 | grep -qE '(passed|✓)' && echo PASS",
      "files": ["packages/core/src/test-utils.ts", "packages/core/src/test-utils.test.ts"],
      "estimatedMinutes": 25,
      "dependsOn": ["turbo-test-task"],
      "sprint": "testing"
    },
    {
      "id": "ci-workflow",
      "title": "Add CI workflow (GitHub Actions)",
      "issue": 18,
      "priority": 6,
      "validationCommand": "test -f .github/workflows/ci.yml && echo PASS",
      "files": [".github/workflows/ci.yml"],
      "estimatedMinutes": 20,
      "dependsOn": ["turbo-test-task"],
      "sprint": "testing"
    },
    {
      "id": "pre-commit-hooks",
      "title": "Add pre-commit hooks (lint, typecheck, test)",
      "issue": 19,
      "priority": 7,
      "validationCommand": "test -f .husky/pre-commit || test -f .git/hooks/pre-commit && echo PASS",
      "files": [".husky/pre-commit", "package.json"],
      "estimatedMinutes": 15,
      "dependsOn": ["ci-workflow"],
      "sprint": "testing"
    },
    {
      "id": "generate-x25519",
      "title": "Implement generateX25519Keypair",
      "issue": 28,
      "priority": 10,
      "validationCommand": "bun test packages/core/src/crypto.test.ts --testNamePattern='generateX25519Keypair'",
      "files": ["packages/core/src/crypto.ts", "packages/core/src/crypto.test.ts"],
      "estimatedMinutes": 30,
      "dependsOn": ["turbo-test-task"],
      "sprint": "crypto"
    },
    {
      "id": "generate-ed25519",
      "title": "Implement generateEd25519Keypair",
      "issue": 29,
      "priority": 11,
      "validationCommand": "bun test packages/core/src/crypto.test.ts --testNamePattern='generateEd25519Keypair'",
      "files": ["packages/core/src/crypto.ts", "packages/core/src/crypto.test.ts"],
      "estimatedMinutes": 20,
      "dependsOn": ["generate-x25519"],
      "sprint": "crypto"
    },
    {
      "id": "export-public-key",
      "title": "Implement exportPublicKey (multibase)",
      "issue": 30,
      "priority": 12,
      "validationCommand": "bun test packages/core/src/crypto.test.ts --testNamePattern='exportPublicKey'",
      "files": ["packages/core/src/crypto.ts", "packages/core/src/crypto.test.ts"],
      "estimatedMinutes": 30,
      "dependsOn": ["generate-x25519"],
      "sprint": "crypto"
    },
    {
      "id": "derive-shared-secret",
      "title": "Implement deriveSharedSecret",
      "issue": 31,
      "priority": 13,
      "validationCommand": "bun test packages/core/src/crypto.test.ts --testNamePattern='deriveSharedSecret'",
      "files": ["packages/core/src/crypto.ts", "packages/core/src/crypto.test.ts"],
      "estimatedMinutes": 20,
      "dependsOn": ["generate-x25519"],
      "sprint": "crypto"
    },
    {
      "id": "envelope-encryption",
      "title": "Implement envelope encryption (DEK + encrypt/decrypt)",
      "issue": 8,
      "priority": 14,
      "validationCommand": "bun test packages/core/src/crypto.test.ts --testNamePattern='envelope'",
      "files": ["packages/core/src/crypto.ts", "packages/core/src/crypto.test.ts"],
      "estimatedMinutes": 45,
      "dependsOn": ["derive-shared-secret"],
      "sprint": "crypto",
      "hitlGate": "Security review required before proceeding"
    },
    {
      "id": "d1-schema",
      "title": "Create D1 schema for encrypted records",
      "issue": 9,
      "priority": 20,
      "validationCommand": "test -f apps/network/schema.sql && bun test apps/network/src/schema.test.ts",
      "files": ["apps/network/schema.sql", "apps/network/src/schema.test.ts"],
      "estimatedMinutes": 30,
      "dependsOn": ["envelope-encryption"],
      "sprint": "storage"
    },
    {
      "id": "pi-agent-wrapper",
      "title": "Implement Pi agent wrapper in packages/agent",
      "issue": 10,
      "priority": 21,
      "validationCommand": "bun test packages/agent/src/agent.test.ts",
      "files": ["packages/agent/src/agent.ts", "packages/agent/src/agent.test.ts"],
      "estimatedMinutes": 45,
      "dependsOn": ["turbo-test-task"],
      "sprint": "storage"
    },
    {
      "id": "encrypted-memory",
      "title": "Implement EncryptedMemory class in packages/agent",
      "issue": 11,
      "priority": 22,
      "validationCommand": "bun test packages/agent/src/memory.test.ts",
      "files": ["packages/agent/src/memory.ts", "packages/agent/src/memory.test.ts"],
      "estimatedMinutes": 60,
      "dependsOn": ["envelope-encryption", "d1-schema"],
      "sprint": "storage"
    },
    {
      "id": "wire-up-agentdo",
      "title": "Wire up AgentDO with Pi agent and encrypted memory",
      "issue": 12,
      "priority": 23,
      "validationCommand": "bun test apps/network/src/agent-do.test.ts",
      "files": ["apps/network/src/agent-do.ts", "apps/network/src/agent-do.test.ts"],
      "estimatedMinutes": 60,
      "dependsOn": ["pi-agent-wrapper", "encrypted-memory"],
      "sprint": "storage",
      "hitlGate": "Phase 1 complete - verify no plaintext in D1"
    },
    {
      "id": "integration-test-harness",
      "title": "Setup integration test harness (D1 mock)",
      "issue": 16,
      "priority": 30,
      "validationCommand": "bun test:integration 2>&1 | grep -qE '(passed|✓|no test)' && echo PASS",
      "files": ["vitest.config.integration.ts", "packages/core/src/__tests__/integration/"],
      "estimatedMinutes": 45,
      "dependsOn": ["d1-schema"],
      "sprint": "testing-advanced"
    },
    {
      "id": "e2e-test-harness",
      "title": "Setup E2E test harness (miniflare)",
      "issue": 17,
      "priority": 31,
      "validationCommand": "bun test:e2e 2>&1 | grep -qE '(passed|✓|no test)' && echo PASS",
      "files": ["vitest.config.e2e.ts", "apps/network/src/__tests__/e2e/"],
      "estimatedMinutes": 60,
      "dependsOn": ["wire-up-agentdo"],
      "sprint": "testing-advanced"
    }
  ],
  "sprints": [
    {
      "id": "bootstrap",
      "name": "Bootstrap",
      "goal": "Monorepo builds and typechecks",
      "stories": ["setup-monorepo"],
      "estimatedHours": 0.25,
      "hitlGate": null
    },
    {
      "id": "testing",
      "name": "Testing Foundation",
      "goal": "Vitest + CI + pre-commit working across monorepo",
      "stories": ["install-vitest", "identity-tests", "vitest-workspace", "turbo-test-task", "test-utilities", "ci-workflow", "pre-commit-hooks"],
      "estimatedHours": 2,
      "hitlGate": null
    },
    {
      "id": "crypto",
      "name": "Crypto Primitives",
      "goal": "X25519 + Ed25519 key generation, exchange, and envelope encryption",
      "stories": ["generate-x25519", "generate-ed25519", "export-public-key", "derive-shared-secret", "envelope-encryption"],
      "estimatedHours": 2.5,
      "hitlGate": "Security review: verify crypto implementation is correct and secure"
    },
    {
      "id": "storage",
      "name": "Encrypted Storage",
      "goal": "D1 schema + Pi agent + EncryptedMemory + AgentDO wired up",
      "stories": ["d1-schema", "pi-agent-wrapper", "encrypted-memory", "wire-up-agentdo"],
      "estimatedHours": 4,
      "hitlGate": "Phase 1 complete: Verify no plaintext in D1, all memories encrypted"
    },
    {
      "id": "testing-advanced",
      "name": "Advanced Testing",
      "goal": "Integration and E2E test harnesses",
      "stories": ["integration-test-harness", "e2e-test-harness"],
      "estimatedHours": 2,
      "hitlGate": null
    }
  ],
  "loopConfig": {
    "maxIterations": 20,
    "validationTimeout": 120,
    "autoCommit": true,
    "commitPrefix": "feat|test|chore|fix",
    "branchPrefix": "feat/",
    "onStoryComplete": {
      "updateParentCheckbox": true,
      "addPRLink": true,
      "createPR": true
    },
    "onStoryFail": {
      "maxRetries": 2,
      "addBlockedLabel": true,
      "commentWithLog": true
    },
    "retrospective": {
      "enabled": true,
      "afterSprint": true,
      "issueTemplate": 20
    },
    "gardening": {
      "updateBlockedIssues": true,
      "closeParentWhenChildrenDone": true,
      "issueTemplate": 23
    }
  },
  "labels": {
    "ready": "agent/ready",
    "claimed": "agent/claimed",
    "blocked": "agent/blocked",
    "review": "agent/review",
    "container": "type/container"
  },
  "issueCategories": {
    "leaf": ["type/task", "agent/ready"],
    "container": ["type/container"],
    "epic": ["type/epic"],
    "meta": ["loop/meta"]
  }
}
